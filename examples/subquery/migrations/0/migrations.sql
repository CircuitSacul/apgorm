CREATE TABLE _migrations ();
CREATE TABLE games ();
CREATE TABLE players ();
CREATE TABLE users ();
ALTER TABLE _migrations ADD COLUMN id_ INTEGER;
ALTER TABLE games ADD COLUMN id_ SERIAL;
ALTER TABLE players ADD COLUMN gameid INTEGER;
ALTER TABLE players ADD COLUMN username VARCHAR(32);
ALTER TABLE users ADD COLUMN name VARCHAR(32);
ALTER TABLE _migrations ALTER COLUMN id_ SET NOT NULL;
ALTER TABLE games ALTER COLUMN id_ SET NOT NULL;
ALTER TABLE players ALTER COLUMN gameid SET NOT NULL;
ALTER TABLE players ALTER COLUMN username SET NOT NULL;
ALTER TABLE users ALTER COLUMN name SET NOT NULL;
ALTER TABLE _migrations ADD CONSTRAINT __migrations_id__primary_key PRIMARY KEY ( id_ );
ALTER TABLE games ADD CONSTRAINT _games_id__primary_key PRIMARY KEY ( id_ );
ALTER TABLE players ADD CONSTRAINT _players_username_gameid_primary_key PRIMARY KEY ( username , gameid );
ALTER TABLE users ADD CONSTRAINT _users_name_primary_key PRIMARY KEY ( name );
ALTER TABLE players ADD CONSTRAINT gameid_fk FOREIGN KEY ( gameid ) REFERENCES games ( id_ ) MATCH SIMPLE ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE players ADD CONSTRAINT username_fk FOREIGN KEY ( username ) REFERENCES users ( name ) MATCH SIMPLE ON DELETE CASCADE ON UPDATE CASCADE;