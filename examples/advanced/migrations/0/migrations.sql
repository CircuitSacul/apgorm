CREATE TABLE _migrations ();
CREATE TABLE games ();
CREATE TABLE players ();
CREATE TABLE users ();
ALTER TABLE _migrations ADD COLUMN id_ INTEGER;
ALTER TABLE games ADD COLUMN id_ SERIAL;
ALTER TABLE games ADD COLUMN name VARCHAR(32);
ALTER TABLE players ADD COLUMN game_id INTEGER;
ALTER TABLE players ADD COLUMN status INTEGER;
ALTER TABLE players ADD COLUMN username VARCHAR(32);
ALTER TABLE users ADD COLUMN nickname VARCHAR(32);
ALTER TABLE users ADD COLUMN username VARCHAR(32);
ALTER TABLE _migrations ALTER COLUMN id_ SET NOT NULL;
ALTER TABLE games ALTER COLUMN id_ SET NOT NULL;
ALTER TABLE games ALTER COLUMN name SET NOT NULL;
ALTER TABLE players ALTER COLUMN game_id SET NOT NULL;
ALTER TABLE players ALTER COLUMN status SET NOT NULL;
ALTER TABLE players ALTER COLUMN username SET NOT NULL;
ALTER TABLE users ALTER COLUMN username SET NOT NULL;
ALTER TABLE players ALTER COLUMN status SET DEFAULT 0;
ALTER TABLE users ALTER COLUMN nickname SET DEFAULT null;
ALTER TABLE _migrations ADD CONSTRAINT _migrations_id__primary_key PRIMARY KEY ( id_ );
ALTER TABLE games ADD CONSTRAINT games_id__primary_key PRIMARY KEY ( id_ );
ALTER TABLE players ADD CONSTRAINT players_username_game_id_primary_key PRIMARY KEY ( username , game_id );
ALTER TABLE users ADD CONSTRAINT users_username_primary_key PRIMARY KEY ( username );
ALTER TABLE players ADD CONSTRAINT game_id_fk FOREIGN KEY ( game_id ) REFERENCES games ( id_ ) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE players ADD CONSTRAINT username_fk FOREIGN KEY ( username ) REFERENCES users ( username ) ON DELETE CASCADE ON UPDATE CASCADE;